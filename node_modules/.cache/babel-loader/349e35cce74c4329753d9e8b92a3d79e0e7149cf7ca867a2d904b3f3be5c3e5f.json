{"ast":null,"code":"var _jsxFileName = \"/Users/christinnenko/Documents/skyPro-git/react-memo-game/src/components/Cards/Cards.jsx\",\n  _s = $RefreshSig$();\nimport { shuffle } from \"lodash\";\nimport { useEffect, useState } from \"react\";\nimport { generateDeck } from \"../../utils/cards\";\nimport styles from \"./Cards.module.css\";\nimport { EndGameModal } from \"../../components/EndGameModal/EndGameModal\";\nimport { Button } from \"../../components/Button/Button\";\nimport { Card } from \"../../components/Card/Card\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { removeAttempts, updateAttempts } from \"../../store/slices\";\nimport { attemptForms, wordEndingChanger } from \"../../helpers\";\nimport { getAllScore } from \"../../api\";\nimport { AlohomoraPower } from \"../Superpowers/AlohomoraPower\";\nimport { PiphanyPower } from \"../Superpowers/PiphanyPower\";\nimport { ToolTips } from \"../../utils/tooltips/tooltip\";\nimport { getTimerValue } from \"../Timer/Timer\";\n\n// Игра закончилась\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst STATUS_LOST = \"STATUS_LOST\";\nconst STATUS_WON = \"STATUS_WON\";\n// Идет игра: карты закрыты, игрок может их открыть\nconst STATUS_IN_PROGRESS = \"STATUS_IN_PROGRESS\";\n// Начало игры: игрок видит все карты в течении нескольких секунд\nconst STATUS_PREVIEW = \"STATUS_PREVIEW\";\n// Игра на паузе\nconst STATUS_PAUSED = \"STATUS_PAUSED\";\ngetTimerValue();\n\n/**\n * Основной компонент игры, внутри него находится вся игровая механика и логика.\n * pairsCount - сколько пар будет в игре\n * previewSeconds - сколько секунд пользователь будет видеть все карты открытыми до начала игры\n * Обычный режим: 1 ошибка = поражение\n * Облегченный режим: 3 ошибки = поражение\n */\nexport function Cards({\n  pairsCount = 3,\n  previewSeconds = 5\n}) {\n  _s();\n  const dispatch = useDispatch();\n\n  // В cards лежит игровое поле - массив карт и их состояние открыта\\закрыта\n  const [cards, setCards] = useState([]);\n  // Текущий статус игры\n  const [status, setStatus] = useState(STATUS_PREVIEW);\n\n  // Дата начала игры\n  const [gameStartDate, setGameStartDate] = useState(null);\n  // Дата конца игры\n  const [gameEndDate, setGameEndDate] = useState(null);\n\n  // Стейт для таймера, высчитывается в setInteval на основе gameStartDate и gameEndDate\n  const [timer, setTimer] = useState({\n    seconds: 0,\n    minutes: 0\n  });\n\n  // количество оставшихся попыток\n  const attempts = useSelector(store => store.game.attempts);\n\n  // Статус режима игры до трех ошибок\n  const isEasyMode = useSelector(store => store.game.isEasyMode);\n\n  // Если допущено 3 ошибки, игра заканчивается\n  useEffect(() => {\n    if (attempts === 0) {\n      finishGame(STATUS_LOST);\n    }\n  });\n  function finishGame(status = STATUS_LOST) {\n    dispatch(removeAttempts());\n    setGameEndDate(new Date());\n    setStatus(status);\n  }\n  function startGame() {\n    const startDate = new Date();\n    setGameEndDate(null);\n    setGameStartDate(startDate);\n    setTimer(getTimerValue(startDate, null));\n    setStatus(STATUS_IN_PROGRESS);\n    setIsPiphanyAvailable(true);\n    setIsPiphanyHover(false);\n    setIsAlohomoraAvailable(true);\n    setIsAlohomoraHover(false);\n  }\n  function resetGame() {\n    dispatch(removeAttempts());\n    setGameStartDate(null);\n    setGameEndDate(null);\n    setTimer(getTimerValue(null, null));\n    setStatus(STATUS_PREVIEW);\n  }\n\n  /**\n   * Обработка основного действия в игре - открытие карты.\n   * После открытия карты игра может переходить в следующие состояния\n   * - \"Игрок выиграл\", если на поле открыты все карты\n   * - \"Игрок проиграл\", если на поле есть две открытые карты без пары\n   * - \"Игра продолжается\", если не случилось первых двух условий\n   */\n  const openCard = clickedCard => {\n    // Если карта уже открыта, то ничего не делаем\n    if (clickedCard.open) {\n      return;\n    }\n    // Игровое поле после открытия кликнутой карты\n    const nextCards = cards.map(card => {\n      if (card.id !== clickedCard.id) {\n        return card;\n      }\n      return {\n        ...card,\n        open: true\n      };\n    });\n    setCards(nextCards);\n    const isPlayerWon = nextCards.every(card => card.open);\n\n    // Победа - все карты на поле открыты\n    if (isPlayerWon) {\n      finishGame(STATUS_WON);\n      return;\n    }\n\n    // Открытые карты на игровом поле\n    const openCards = nextCards.filter(card => card.open);\n\n    // Ищем открытые карты, у которых нет пары среди других открытых\n    const openCardsWithoutPair = openCards.filter(card => {\n      const sameCards = openCards.filter(openCard => card.suit === openCard.suit && card.rank === openCard.rank);\n      if (sameCards.length < 2) {\n        return true;\n      }\n      return false;\n    });\n    const playerLost = openCardsWithoutPair.length >= 2;\n\n    // Если на поле 2 открытые карты без пары - Обычный режим: \"Игрок проиграл\". Облегченный режим: \"Игра продолжается\"\n    if (playerLost) {\n      dispatch(updateAttempts());\n      if (!isEasyMode) {\n        finishGame(STATUS_LOST);\n      } else {\n        const updatedCards = nextCards.map(card => {\n          if (openCardsWithoutPair.some(openCard => openCard.id === card.id)) {\n            if (card.open) {\n              setTimeout(() => {\n                setCards(prevCards => {\n                  const updated = prevCards.map(cardId => cardId.id === card.id ? {\n                    ...cardId,\n                    open: false\n                  } : cardId);\n                  return updated;\n                });\n              }, 1000);\n            }\n          }\n          return card;\n        });\n        setCards(updatedCards);\n      }\n      return;\n    }\n  };\n  const isGameEnded = status === STATUS_LOST || status === STATUS_WON;\n\n  //при победе на уровне игры 3 и если результат по времени лучше чем у последнего игрока в лидерборде, устанавливаем isLeader в true для внесение игрока в лидерборд\n  const [isLeader, setIsLeader] = useState(false);\n  const currentLevel = useSelector(store => store.game.currentLevel);\n  useEffect(() => {\n    if (status === STATUS_WON && currentLevel === 3) {\n      getAllScore().then(data => {\n        const leaders = data.leaders; // Получаем список лидеров из API\n        console.log(\"Все лидеры:\", leaders);\n        const timeLastLeaders = leaders.reduce((maxTime, leader) => {\n          return Math.max(maxTime, leader.time);\n        }, 0);\n        console.log(\"Время последнего лидера:\", timeLastLeaders);\n        const {\n          minutes,\n          seconds\n        } = timer;\n        const userTime = minutes * 60 + seconds;\n        console.log(\"Таймер пользователя:\", userTime);\n        if (timeLastLeaders > userTime || leaders.length < 10) {\n          setIsLeader(true);\n          console.log(\"Пользователь - лидер!\");\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n    }\n  }, [status, currentLevel]);\n\n  // Игровой цикл\n  useEffect(() => {\n    // В статусах кроме превью доп логики не требуется\n    if (status !== STATUS_PREVIEW) {\n      return;\n    }\n\n    // В статусе превью мы\n    if (pairsCount > 36) {\n      alert(\"Столько пар сделать невозможно\");\n      return;\n    }\n    setCards(() => {\n      return shuffle(generateDeck(pairsCount, 10));\n    });\n    const timerId = setTimeout(() => {\n      startGame();\n    }, previewSeconds * 1000);\n    return () => {\n      clearTimeout(timerId);\n    };\n  }, [status, pairsCount, previewSeconds]);\n\n  // Обновляем значение таймера в интервале\n  useEffect(() => {\n    const intervalId = setInterval(() => {\n      setTimer(getTimerValue(gameStartDate, gameEndDate));\n    }, 300);\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [gameStartDate, gameEndDate, STATUS_PAUSED]);\n\n  //устанавливаем корректное окончание слова \"попытка\" в зависимости от оставшегося числа попыток\n  const attemptsText = wordEndingChanger.changeEnding(attempts, attemptForms);\n\n  //Реализация суперсил\n  const [isPiphanyAvailable, setIsPiphanyAvailable] = useState(true); // Доступно ли использование \"Прозрение\"\n  const [isAlohomoraAvailable, setIsAlohomoraAvailable] = useState(true); // Доступно ли использование \"Алохомора\"\n  const [isPiphanyHover, setIsPiphanyHover] = useState(false);\n  const [isAlohomoraHover, setIsAlohomoraHover] = useState(false);\n  const onPiphanyHover = () => {\n    setIsPiphanyHover(true);\n  };\n  const onPiphanyHoverLeave = () => {\n    setIsPiphanyHover(false);\n  };\n  const onAlohomoraHover = () => {\n    setIsAlohomoraHover(true);\n  };\n  const onAlohomoraHoverLeave = () => {\n    setIsAlohomoraHover(false);\n  };\n\n  //суперсила \"Прозрение\": На 5 секунд показываются все карты. Таймер длительности игры на это время останавливается.\n  function usePiphany() {\n    setStatus(STATUS_PAUSED);\n    setIsPiphanyAvailable(false);\n    const closedCards = cards.filter(card => !card.open);\n    cards.map(card => card.open = true);\n    setCards(cards.map(card => {\n      if (closedCards.includes(card)) {\n        return {\n          ...card,\n          open: false\n        };\n      } else {\n        return card;\n      }\n    }));\n\n    // через 5 сек продолжать игру\n    setTimeout(() => {\n      setStatus(STATUS_IN_PROGRESS);\n    }, 5000);\n  }\n\n  //суперсила \"Алохомора\": Открывается случайная пара карт.\n  function useAlohomora() {\n    setIsAlohomoraAvailable(false);\n    const closedCards = cards.filter(card => !card.open);\n    const firstRandomIndex = Math.floor(Math.random() * closedCards.length);\n    const firstRandomCard = closedCards[firstRandomIndex];\n    closedCards.splice(firstRandomIndex, 1);\n    const secondRandomIndex = Math.floor(Math.random() * (closedCards.length - 1));\n    const secondRandomCard = closedCards[secondRandomIndex];\n    closedCards.splice(secondRandomIndex, 1);\n    setCards(cards.map(card => {\n      if (card === firstRandomCard || card === secondRandomCard) {\n        return {\n          ...card,\n          open: true\n        };\n      } else {\n        return card;\n      }\n    }));\n\n    //проверка на победу\n    const isPlayerWon = closedCards.every(card => card.open);\n    if (isPlayerWon) {\n      finishGame(STATUS_WON);\n      return;\n    }\n  }\n  const withoutSuperpowers = isPiphanyAvailable && isAlohomoraAvailable;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.container,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.header,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.timerContainer,\n        children: status === STATUS_PREVIEW ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: styles.previewText,\n            children: \"\\u0417\\u0430\\u043F\\u043E\\u043C\\u0438\\u043D\\u0430\\u0439\\u0442\\u0435 \\u043F\\u0430\\u0440\\u044B!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: styles.previewDescription,\n            children: [\"\\u0418\\u0433\\u0440\\u0430 \\u043D\\u0430\\u0447\\u043D\\u0435\\u0442\\u0441\\u044F \\u0447\\u0435\\u0440\\u0435\\u0437 \", previewSeconds, \" \\u0441\\u0435\\u043A\\u0443\\u043D\\u0434\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.timer,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.timerValue,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.timerDescription,\n                children: \"min\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: timer.minutes.toString().padStart(2, \"0\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 338,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 17\n            }, this), \".\", /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.timerValue,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.timerDescription,\n                children: \"sec\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: timer.seconds.toString().padStart(2, \"0\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 15\n          }, this), isEasyMode && (status === STATUS_IN_PROGRESS || status === STATUS_PAUSED) ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.attempts,\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"\\u041E\\u0441\\u0442\\u0430\\u043B\\u043E\\u0441\\u044C \", /*#__PURE__*/_jsxDEV(\"span\", {\n                children: attempts\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 349,\n                columnNumber: 30\n              }, this), attemptsText]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 347,\n            columnNumber: 17\n          }, this) : null]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this), status === STATUS_IN_PROGRESS || status === STATUS_PAUSED ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.buttonContainer,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.powersContainer,\n          children: status === STATUS_IN_PROGRESS || status === STATUS_PAUSED ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(PiphanyPower, {\n              isAvailable: isPiphanyAvailable,\n              onClick: usePiphany,\n              onMouseEnter: onPiphanyHover,\n              onMouseLeave: onPiphanyHoverLeave,\n              setIsPiphanyHover: setIsPiphanyHover,\n              isAlohomoraHover: isAlohomoraHover,\n              isAlohomoraAvailable: isAlohomoraAvailable\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(AlohomoraPower, {\n              isAvailable: isAlohomoraAvailable,\n              onClick: useAlohomora,\n              onMouseEnter: onAlohomoraHover,\n              onMouseLeave: onAlohomoraHoverLeave,\n              setIsAlohomoraHover: setIsAlohomoraHover,\n              isPiphanyHover: isPiphanyHover,\n              isPiphanyAvailable: isPiphanyAvailable\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 19\n            }, this), isPiphanyHover && isPiphanyAvailable || isAlohomoraHover && isAlohomoraAvailable ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [isPiphanyHover && isPiphanyAvailable && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: isAlohomoraAvailable ? styles.toolTipPiphany : \"\",\n                children: /*#__PURE__*/_jsxDEV(ToolTips, {\n                  title: \"Прозрение\",\n                  text: \"На 5 секунд показываются все карты. Таймер длительности игры на это время останавливается.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 384,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 383,\n                columnNumber: 25\n              }, this), isAlohomoraHover && isAlohomoraAvailable && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: isPiphanyAvailable ? styles.toolTipAlohomora : \"\",\n                children: /*#__PURE__*/_jsxDEV(ToolTips, {\n                  title: \"Алохомора\",\n                  text: \"Открывается случайная пара карт.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 394,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true) : null]\n          }, void 0, true) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: resetGame,\n          children: \"\\u041D\\u0430\\u0447\\u0430\\u0442\\u044C \\u0437\\u0430\\u043D\\u043E\\u0432\\u043E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 11\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.cards,\n      children: cards.map(card => /*#__PURE__*/_jsxDEV(Card, {\n        onClick: () => openCard(card),\n        open: status !== STATUS_IN_PROGRESS ? true : card.open,\n        suit: card.suit,\n        rank: card.rank\n      }, card.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 7\n    }, this), isGameEnded ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.modalContainer,\n      children: /*#__PURE__*/_jsxDEV(EndGameModal, {\n        isWon: status === STATUS_WON,\n        gameDurationSeconds: timer.seconds,\n        gameDurationMinutes: timer.minutes,\n        onClick: resetGame,\n        isLeader: isLeader,\n        withoutSuperpowers: withoutSuperpowers\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 9\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 325,\n    columnNumber: 5\n  }, this);\n}\n_s(Cards, \"EvQTGEXa9uwwSTOzg461KW4NH2o=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector];\n});\n_c = Cards;\nvar _c;\n$RefreshReg$(_c, \"Cards\");","map":{"version":3,"names":["shuffle","useEffect","useState","generateDeck","styles","EndGameModal","Button","Card","useDispatch","useSelector","removeAttempts","updateAttempts","attemptForms","wordEndingChanger","getAllScore","AlohomoraPower","PiphanyPower","ToolTips","getTimerValue","jsxDEV","_jsxDEV","Fragment","_Fragment","STATUS_LOST","STATUS_WON","STATUS_IN_PROGRESS","STATUS_PREVIEW","STATUS_PAUSED","Cards","pairsCount","previewSeconds","_s","dispatch","cards","setCards","status","setStatus","gameStartDate","setGameStartDate","gameEndDate","setGameEndDate","timer","setTimer","seconds","minutes","attempts","store","game","isEasyMode","finishGame","Date","startGame","startDate","setIsPiphanyAvailable","setIsPiphanyHover","setIsAlohomoraAvailable","setIsAlohomoraHover","resetGame","openCard","clickedCard","open","nextCards","map","card","id","isPlayerWon","every","openCards","filter","openCardsWithoutPair","sameCards","suit","rank","length","playerLost","updatedCards","some","setTimeout","prevCards","updated","cardId","isGameEnded","isLeader","setIsLeader","currentLevel","then","data","leaders","console","log","timeLastLeaders","reduce","maxTime","leader","Math","max","time","userTime","catch","error","alert","timerId","clearTimeout","intervalId","setInterval","clearInterval","attemptsText","changeEnding","isPiphanyAvailable","isAlohomoraAvailable","isPiphanyHover","isAlohomoraHover","onPiphanyHover","onPiphanyHoverLeave","onAlohomoraHover","onAlohomoraHoverLeave","usePiphany","closedCards","includes","useAlohomora","firstRandomIndex","floor","random","firstRandomCard","splice","secondRandomIndex","secondRandomCard","withoutSuperpowers","className","container","children","header","timerContainer","previewText","fileName","_jsxFileName","lineNumber","columnNumber","previewDescription","timerValue","timerDescription","toString","padStart","buttonContainer","powersContainer","isAvailable","onClick","onMouseEnter","onMouseLeave","toolTipPiphany","title","text","toolTipAlohomora","modalContainer","isWon","gameDurationSeconds","gameDurationMinutes","_c","$RefreshReg$"],"sources":["/Users/christinnenko/Documents/skyPro-git/react-memo-game/src/components/Cards/Cards.jsx"],"sourcesContent":["import { shuffle } from \"lodash\";\nimport { useEffect, useState } from \"react\";\nimport { generateDeck } from \"../../utils/cards\";\nimport styles from \"./Cards.module.css\";\nimport { EndGameModal } from \"../../components/EndGameModal/EndGameModal\";\nimport { Button } from \"../../components/Button/Button\";\nimport { Card } from \"../../components/Card/Card\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { removeAttempts, updateAttempts } from \"../../store/slices\";\nimport { attemptForms, wordEndingChanger } from \"../../helpers\";\nimport { getAllScore } from \"../../api\";\nimport { AlohomoraPower } from \"../Superpowers/AlohomoraPower\";\nimport { PiphanyPower } from \"../Superpowers/PiphanyPower\";\nimport { ToolTips } from \"../../utils/tooltips/tooltip\";\nimport { getTimerValue } from \"../Timer/Timer\";\n\n// Игра закончилась\nconst STATUS_LOST = \"STATUS_LOST\";\nconst STATUS_WON = \"STATUS_WON\";\n// Идет игра: карты закрыты, игрок может их открыть\nconst STATUS_IN_PROGRESS = \"STATUS_IN_PROGRESS\";\n// Начало игры: игрок видит все карты в течении нескольких секунд\nconst STATUS_PREVIEW = \"STATUS_PREVIEW\";\n// Игра на паузе\nconst STATUS_PAUSED = \"STATUS_PAUSED\";\n\ngetTimerValue();\n\n/**\n * Основной компонент игры, внутри него находится вся игровая механика и логика.\n * pairsCount - сколько пар будет в игре\n * previewSeconds - сколько секунд пользователь будет видеть все карты открытыми до начала игры\n * Обычный режим: 1 ошибка = поражение\n * Облегченный режим: 3 ошибки = поражение\n */\nexport function Cards({ pairsCount = 3, previewSeconds = 5 }) {\n  const dispatch = useDispatch();\n\n  // В cards лежит игровое поле - массив карт и их состояние открыта\\закрыта\n  const [cards, setCards] = useState([]);\n  // Текущий статус игры\n  const [status, setStatus] = useState(STATUS_PREVIEW);\n\n  // Дата начала игры\n  const [gameStartDate, setGameStartDate] = useState(null);\n  // Дата конца игры\n  const [gameEndDate, setGameEndDate] = useState(null);\n\n  // Стейт для таймера, высчитывается в setInteval на основе gameStartDate и gameEndDate\n  const [timer, setTimer] = useState({\n    seconds: 0,\n    minutes: 0,\n  });\n\n  // количество оставшихся попыток\n  const attempts = useSelector(store => store.game.attempts);\n\n  // Статус режима игры до трех ошибок\n  const isEasyMode = useSelector(store => store.game.isEasyMode);\n\n  // Если допущено 3 ошибки, игра заканчивается\n  useEffect(() => {\n    if (attempts === 0) {\n      finishGame(STATUS_LOST);\n    }\n  });\n\n  function finishGame(status = STATUS_LOST) {\n    dispatch(removeAttempts());\n    setGameEndDate(new Date());\n    setStatus(status);\n  }\n  function startGame() {\n    const startDate = new Date();\n    setGameEndDate(null);\n    setGameStartDate(startDate);\n    setTimer(getTimerValue(startDate, null));\n    setStatus(STATUS_IN_PROGRESS);\n    setIsPiphanyAvailable(true);\n    setIsPiphanyHover(false);\n    setIsAlohomoraAvailable(true);\n    setIsAlohomoraHover(false);\n  }\n\n  function resetGame() {\n    dispatch(removeAttempts());\n    setGameStartDate(null);\n    setGameEndDate(null);\n    setTimer(getTimerValue(null, null));\n    setStatus(STATUS_PREVIEW);\n  }\n\n  /**\n   * Обработка основного действия в игре - открытие карты.\n   * После открытия карты игра может переходить в следующие состояния\n   * - \"Игрок выиграл\", если на поле открыты все карты\n   * - \"Игрок проиграл\", если на поле есть две открытые карты без пары\n   * - \"Игра продолжается\", если не случилось первых двух условий\n   */\n  const openCard = clickedCard => {\n    // Если карта уже открыта, то ничего не делаем\n    if (clickedCard.open) {\n      return;\n    }\n    // Игровое поле после открытия кликнутой карты\n    const nextCards = cards.map(card => {\n      if (card.id !== clickedCard.id) {\n        return card;\n      }\n\n      return {\n        ...card,\n        open: true,\n      };\n    });\n\n    setCards(nextCards);\n\n    const isPlayerWon = nextCards.every(card => card.open);\n\n    // Победа - все карты на поле открыты\n    if (isPlayerWon) {\n      finishGame(STATUS_WON);\n      return;\n    }\n\n    // Открытые карты на игровом поле\n    const openCards = nextCards.filter(card => card.open);\n\n    // Ищем открытые карты, у которых нет пары среди других открытых\n    const openCardsWithoutPair = openCards.filter(card => {\n      const sameCards = openCards.filter(openCard => card.suit === openCard.suit && card.rank === openCard.rank);\n\n      if (sameCards.length < 2) {\n        return true;\n      }\n\n      return false;\n    });\n\n    const playerLost = openCardsWithoutPair.length >= 2;\n\n    // Если на поле 2 открытые карты без пары - Обычный режим: \"Игрок проиграл\". Облегченный режим: \"Игра продолжается\"\n    if (playerLost) {\n      dispatch(updateAttempts());\n\n      if (!isEasyMode) {\n        finishGame(STATUS_LOST);\n      } else {\n        const updatedCards = nextCards.map(card => {\n          if (openCardsWithoutPair.some(openCard => openCard.id === card.id)) {\n            if (card.open) {\n              setTimeout(() => {\n                setCards(prevCards => {\n                  const updated = prevCards.map(cardId =>\n                    cardId.id === card.id ? { ...cardId, open: false } : cardId,\n                  );\n                  return updated;\n                });\n              }, 1000);\n            }\n          }\n          return card;\n        });\n        setCards(updatedCards);\n      }\n      return;\n    }\n  };\n\n  const isGameEnded = status === STATUS_LOST || status === STATUS_WON;\n\n  //при победе на уровне игры 3 и если результат по времени лучше чем у последнего игрока в лидерборде, устанавливаем isLeader в true для внесение игрока в лидерборд\n  const [isLeader, setIsLeader] = useState(false);\n  const currentLevel = useSelector(store => store.game.currentLevel);\n\n  useEffect(() => {\n    if (status === STATUS_WON && currentLevel === 3) {\n      getAllScore()\n        .then(data => {\n          const leaders = data.leaders; // Получаем список лидеров из API\n          console.log(\"Все лидеры:\", leaders);\n          const timeLastLeaders = leaders.reduce((maxTime, leader) => {\n            return Math.max(maxTime, leader.time);\n          }, 0);\n          console.log(\"Время последнего лидера:\", timeLastLeaders);\n\n          const { minutes, seconds } = timer;\n          const userTime = minutes * 60 + seconds;\n          console.log(\"Таймер пользователя:\", userTime);\n          if (timeLastLeaders > userTime || leaders.length < 10) {\n            setIsLeader(true);\n            console.log(\"Пользователь - лидер!\");\n          }\n        })\n        .catch(error => {\n          console.error(error);\n        });\n    }\n  }, [status, currentLevel]);\n\n  // Игровой цикл\n  useEffect(() => {\n    // В статусах кроме превью доп логики не требуется\n    if (status !== STATUS_PREVIEW) {\n      return;\n    }\n\n    // В статусе превью мы\n    if (pairsCount > 36) {\n      alert(\"Столько пар сделать невозможно\");\n      return;\n    }\n\n    setCards(() => {\n      return shuffle(generateDeck(pairsCount, 10));\n    });\n\n    const timerId = setTimeout(() => {\n      startGame();\n    }, previewSeconds * 1000);\n\n    return () => {\n      clearTimeout(timerId);\n    };\n  }, [status, pairsCount, previewSeconds]);\n\n  // Обновляем значение таймера в интервале\n  useEffect(() => {\n    const intervalId = setInterval(() => {\n      setTimer(getTimerValue(gameStartDate, gameEndDate));\n    }, 300);\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [gameStartDate, gameEndDate, STATUS_PAUSED]);\n\n  //устанавливаем корректное окончание слова \"попытка\" в зависимости от оставшегося числа попыток\n  const attemptsText = wordEndingChanger.changeEnding(attempts, attemptForms);\n\n  //Реализация суперсил\n  const [isPiphanyAvailable, setIsPiphanyAvailable] = useState(true); // Доступно ли использование \"Прозрение\"\n  const [isAlohomoraAvailable, setIsAlohomoraAvailable] = useState(true); // Доступно ли использование \"Алохомора\"\n  const [isPiphanyHover, setIsPiphanyHover] = useState(false);\n  const [isAlohomoraHover, setIsAlohomoraHover] = useState(false);\n\n  const onPiphanyHover = () => {\n    setIsPiphanyHover(true);\n  };\n\n  const onPiphanyHoverLeave = () => {\n    setIsPiphanyHover(false);\n  };\n\n  const onAlohomoraHover = () => {\n    setIsAlohomoraHover(true);\n  };\n\n  const onAlohomoraHoverLeave = () => {\n    setIsAlohomoraHover(false);\n  };\n\n  //суперсила \"Прозрение\": На 5 секунд показываются все карты. Таймер длительности игры на это время останавливается.\n  function usePiphany() {\n    setStatus(STATUS_PAUSED);\n    setIsPiphanyAvailable(false);\n\n    const closedCards = cards.filter(card => !card.open);\n    cards.map(card => (card.open = true));\n\n    setCards(\n      cards.map(card => {\n        if (closedCards.includes(card)) {\n          return { ...card, open: false };\n        } else {\n          return card;\n        }\n      }),\n    );\n\n    // через 5 сек продолжать игру\n    setTimeout(() => {\n      setStatus(STATUS_IN_PROGRESS);\n    }, 5000);\n  }\n\n  //суперсила \"Алохомора\": Открывается случайная пара карт.\n  function useAlohomora() {\n    setIsAlohomoraAvailable(false);\n\n    const closedCards = cards.filter(card => !card.open);\n\n    const firstRandomIndex = Math.floor(Math.random() * closedCards.length);\n    const firstRandomCard = closedCards[firstRandomIndex];\n\n    closedCards.splice(firstRandomIndex, 1);\n\n    const secondRandomIndex = Math.floor(Math.random() * (closedCards.length - 1));\n    const secondRandomCard = closedCards[secondRandomIndex];\n\n    closedCards.splice(secondRandomIndex, 1);\n\n    setCards(\n      cards.map(card => {\n        if (card === firstRandomCard || card === secondRandomCard) {\n          return { ...card, open: true };\n        } else {\n          return card;\n        }\n      }),\n    );\n\n    //проверка на победу\n    const isPlayerWon = closedCards.every(card => card.open);\n\n    if (isPlayerWon) {\n      finishGame(STATUS_WON);\n      return;\n    }\n  }\n\n  const withoutSuperpowers = isPiphanyAvailable && isAlohomoraAvailable;\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.header}>\n        <div className={styles.timerContainer}>\n          {status === STATUS_PREVIEW ? (\n            <div>\n              <p className={styles.previewText}>Запоминайте пары!</p>\n              <p className={styles.previewDescription}>Игра начнется через {previewSeconds} секунд</p>\n            </div>\n          ) : (\n            <>\n              <div className={styles.timer}>\n                <div className={styles.timerValue}>\n                  <div className={styles.timerDescription}>min</div>\n                  <div>{timer.minutes.toString().padStart(2, \"0\")}</div>\n                </div>\n                .\n                <div className={styles.timerValue}>\n                  <div className={styles.timerDescription}>sec</div>\n                  <div>{timer.seconds.toString().padStart(2, \"0\")}</div>\n                </div>\n              </div>\n              {isEasyMode && (status === STATUS_IN_PROGRESS || status === STATUS_PAUSED) ? (\n                <div className={styles.attempts}>\n                  <p>\n                    Осталось <span>{attempts}</span>\n                    {attemptsText}\n                  </p>\n                </div>\n              ) : null}\n            </>\n          )}\n        </div>\n        {status === STATUS_IN_PROGRESS || status === STATUS_PAUSED ? (\n          <div className={styles.buttonContainer}>\n            <div className={styles.powersContainer}>\n              {status === STATUS_IN_PROGRESS || status === STATUS_PAUSED ? (\n                <>\n                  <PiphanyPower\n                    isAvailable={isPiphanyAvailable}\n                    onClick={usePiphany}\n                    onMouseEnter={onPiphanyHover}\n                    onMouseLeave={onPiphanyHoverLeave}\n                    setIsPiphanyHover={setIsPiphanyHover}\n                    isAlohomoraHover={isAlohomoraHover}\n                    isAlohomoraAvailable={isAlohomoraAvailable}\n                  />\n                  <AlohomoraPower\n                    isAvailable={isAlohomoraAvailable}\n                    onClick={useAlohomora}\n                    onMouseEnter={onAlohomoraHover}\n                    onMouseLeave={onAlohomoraHoverLeave}\n                    setIsAlohomoraHover={setIsAlohomoraHover}\n                    isPiphanyHover={isPiphanyHover}\n                    isPiphanyAvailable={isPiphanyAvailable}\n                  />\n                  {(isPiphanyHover && isPiphanyAvailable) || (isAlohomoraHover && isAlohomoraAvailable) ? (\n                    <>\n                      {isPiphanyHover && isPiphanyAvailable && (\n                        <div className={isAlohomoraAvailable ? styles.toolTipPiphany : \"\"}>\n                          <ToolTips\n                            title={\"Прозрение\"}\n                            text={\n                              \"На 5 секунд показываются все карты. Таймер длительности игры на это время останавливается.\"\n                            }\n                          />\n                        </div>\n                      )}\n                      {isAlohomoraHover && isAlohomoraAvailable && (\n                        <div className={isPiphanyAvailable ? styles.toolTipAlohomora : \"\"}>\n                          <ToolTips title={\"Алохомора\"} text={\"Открывается случайная пара карт.\"} />\n                        </div>\n                      )}\n                    </>\n                  ) : null}\n                </>\n              ) : null}\n            </div>\n            <Button onClick={resetGame}>Начать заново</Button>\n          </div>\n        ) : null}\n      </div>\n      <div className={styles.cards}>\n        {cards.map(card => (\n          <Card\n            key={card.id}\n            onClick={() => openCard(card)}\n            open={status !== STATUS_IN_PROGRESS ? true : card.open}\n            suit={card.suit}\n            rank={card.rank}\n          />\n        ))}\n      </div>\n      {isGameEnded ? (\n        <div className={styles.modalContainer}>\n          <EndGameModal\n            isWon={status === STATUS_WON}\n            gameDurationSeconds={timer.seconds}\n            gameDurationMinutes={timer.minutes}\n            onClick={resetGame}\n            isLeader={isLeader}\n            withoutSuperpowers={withoutSuperpowers}\n          />\n        </div>\n      ) : null}\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}